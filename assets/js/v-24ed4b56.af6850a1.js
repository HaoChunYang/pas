(self.webpackChunkbugu=self.webpackChunkbugu||[]).push([[5314],{1497:(e,n,a)=>{"use strict";a.r(n),a.d(n,{data:()=>l});const l={key:"v-24ed4b56",path:"/old_blog/Incompatible%20pointer%20types%20assigning%20to%20'id%3C%3E'%20from%20'Class'.html",title:"",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"警告：",slug:"警告",children:[]},{level:2,title:"分析：",slug:"分析",children:[]},{level:2,title:"解决：",slug:"解决",children:[]},{level:2,title:"单例类解决：",slug:"单例类解决",children:[]},{level:2,title:"最终：使用单例类来调用方法",slug:"最终-使用单例类来调用方法",children:[]}],filePathRelative:"old_blog/Incompatible pointer types assigning to 'id<>' from 'Class'.md",git:{updatedTime:1597237797e3}}},4541:(e,n,a)=>{"use strict";a.r(n),a.d(n,{default:()=>s});const l=(0,a(6252).uE)('<p>Incompatible pointer types assigning to &#39;id&lt;&gt;&#39; from &#39;Class&#39;</p><p><strong>自定义的Utility类</strong></p><ul><li>Utility.h：</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@interface Utility : NSObject &lt;AVAudioPlayerDelegate&gt;\n\n+ (void)playAudioFromFileName:(NSString *)name ofType:(NSString *)type withPlayerFinishCallback:(SEL)callback onObject:(id)callbackObject;\n@end\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>Utility.m：</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@implementation Utility\n\nstatic AVAudioPlayer *audioPlayer;\n\n+ (void)playAudioFromFileName:(NSString *)name ofType:(NSString *)type withPlayerFinishCallback:(SEL)callback onObject:(id)callbackObject \n{\n   audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:[self getResourceURLForName:name ofType:type] error:nil];\n   audioPlayer.delegate = self; //这行会产生警告:warning:️:warning:️\n\n}\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="警告"><a class="header-anchor" href="#警告">#</a> 警告：</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Incompatible pointer types assigning to &#39;id&lt;AVAudioPlayerDelegate&gt;&#39; from &#39;Class&#39;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="分析"><a class="header-anchor" href="#分析">#</a> 分析：</h2><p>所声明的方法作为该类的类方法，并且想让这个类的对象 <strong>使用代理，却不能添加协议类对象。</strong></p><h2 id="解决"><a class="header-anchor" href="#解决">#</a> 解决：</h2><p>需要更改<code>[playAudioFromFileName: ofType: withPlayerFinishCallback: onObject: ]</code>为实例(对象)方法，并创建一个该类的实例方法作为代理。 也许你想要一个实用共享于所有调用者的实例，可使用单例模式。</p><h2 id="单例类解决"><a class="header-anchor" href="#单例类解决">#</a> 单例类解决：</h2><ul><li>Utility.h：</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@interface Utility : NSObject &lt;AVAudioPlayerDelegate&gt;\n+ (Utility *)sharedUtility;\n\n- (void)playAudioFromFileName:(NSString *)name ofType:(NSString *)type withPlayerFinishCallback:(SEL)callback onObject:(id)callbackObject;\n@end\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>Utility.m：</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@implementation Utility\n\n+ (Utility *)sharedUtility\n{\n    static Utility *theUtility;\n    @synchronized(self) {\n    if (!theUtility)\n       theUtility = [[self alloc] init];\n    }\n    return theUtility;\n}\n\n// 对象(减号)方法\n- (void)playAudioFromFileName:(NSString *)name ofType:(NSString *)type withPlayerFinishCallback:(SEL)callback onObject:(id)callbackObject\n{\n    audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL: [self getResourceURLForName:name ofType:type] error: nil];\n    audioPlayer.delegate = self;\n}\n\n@end\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="最终-使用单例类来调用方法"><a class="header-anchor" href="#最终-使用单例类来调用方法">#</a> 最终：使用单例类来调用方法</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>[[Utility sharedUtility] playAudioFromFileName:@&quot;Free Loop&quot; ofType:&quot;mp3&quot; \\\nwithPlayerFinishCallback:@selector(doneFinishNotice:) onObject:daniel];\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>作者：goyohol 链接：https://www.jianshu.com/p/9abf0d438245 来源：简书 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>',20),s={render:function(e,n){return l}}}}]);