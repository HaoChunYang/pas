(self.webpackChunkbugu=self.webpackChunkbugu||[]).push([[8043],{8622:(n,s,a)=>{"use strict";a.r(s),a.d(s,{data:()=>t});const t={key:"v-7bdcdfac",path:"/iOS/iOS%E5%AF%B9url%E5%8C%85%E5%90%AB%E7%9A%84%E4%B8%AD%E6%96%87%E8%BF%9B%E8%A1%8C%E8%BD%AC%E7%A0%81.html",title:"iOS对url包含的中文进行转码",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"Problem",slug:"problem",children:[]},{level:2,title:"Analysis",slug:"analysis",children:[]},{level:2,title:"Solution",slug:"solution",children:[]}],filePathRelative:"iOS/iOS对url包含的中文进行转码.md",git:{updatedTime:1599731786e3}}},4730:(n,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>e});const t=(0,a(6252).uE)('<h1 id="ios对url包含的中文进行转码"><a class="header-anchor" href="#ios对url包含的中文进行转码">#</a> iOS对url包含的中文进行转码</h1><h2 id="problem"><a class="header-anchor" href="#problem">#</a> Problem</h2><p>ios中打开url包含中文时不会自动转码，并且打不开页面。</p><h2 id="analysis"><a class="header-anchor" href="#analysis">#</a> Analysis</h2><p>ios中打开url包含中文时不会自动转码。 在<code>webview</code>中加载时，需要行进行转码。</p><h2 id="solution"><a class="header-anchor" href="#solution">#</a> Solution</h2><ol><li>如果知道中文没有转码时，可以使用以下方式。</li></ol><div class="language-swift ext-swift line-numbers-mode"><pre class="language-swift"><code><span class="token comment">// 对url中的中文进行转码（如果已知url中的中文没有进行utf-8转码）</span>\nurl <span class="token operator">=</span> <span class="token punctuation">[</span>url stringByAddingPercentEncodingWithAllowedCharacters<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token builtin">NSCharacterSet</span> <span class="token builtin">URLQueryAllowedCharacterSet</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>如果url所包含中文已经转码，也可能没有转码，需要仅对其中的中文部分进行转码。</li></ol><div class="language-swift ext-swift line-numbers-mode"><pre class="language-swift"><code><span class="token function">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;原url:%@&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token builtin">NSString</span> <span class="token operator">*</span>encodedString <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>\n<span class="token function">CFBridgingRelease</span><span class="token punctuation">(</span><span class="token function">CFURLCreateStringByAddingPercentEscape</span><span class="token punctuation">(</span><span class="token constant">kCFAllocatorDefault</span><span class="token punctuation">,</span>\n                                                          \n        <span class="token punctuation">(</span><span class="token builtin">CFStringRef</span><span class="token punctuation">)</span>url<span class="token punctuation">,</span>\n                                                          \n        <span class="token punctuation">(</span><span class="token builtin">CFStringRef</span><span class="token punctuation">)</span>@<span class="token string">&quot;!$&amp;&#39;()*+,-./:;=?@_~%#[]&quot;</span><span class="token punctuation">,</span>\n                                                          \n        <span class="token constant">NULL</span><span class="token punctuation">,</span>\n                                                          \n        kCFStringEncodingUTF8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;转码url:%@&quot;</span><span class="token punctuation">,</span>  encodedString<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div>',10),e={render:function(n,s){return t}}}}]);